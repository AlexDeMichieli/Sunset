name: CodeQL Analysis

on: [push, pull_request]

jobs:
  codeql:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Setup CodeQL
      uses: actions/setup-codeql@v1
      with:
        language: ruby
        # Replace <language> with the language of your project (e.g. "python", "java", "csharp" etc)

    - name: Run CodeQL
      run: codeql database scan --format sarif --output-file analysis.sarif ruby .

    - name: Archive SARIF
      run: |
        echo "::set-output name=sarif::$(pwd)/analysis.sarif"

    - name: Upload SARIF
      uses: actions/upload-artifact@v2
      with:
        name: sarif-file
        path: analysis.sarif
